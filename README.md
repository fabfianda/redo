Stack based port of jekor/redo
